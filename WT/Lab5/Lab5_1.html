<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>

<body>
    <input type="text" id="answer" />
    <div>
        <button onclick="answer.value+='%'">%</button>
        <button onclick="answer.value=''">AC</button>
        <button onclick="cut()">C</button>
        <button onclick="answer.value+='/'">/</button>
        <button onclick="answer.value+='('">(</button>
        <button onclick="answer.value+=')'">)</button>
    </div>
    <div>
        <button onclick="answer.value+='7'">7</button>
        <button onclick="answer.value+='8'">8</button>
        <button onclick="answer.value+='9'">9</button>
        <button onclick="answer.value+='x'">x</button>
        <button onclick="answer.value+='!'">!</button>
    </div>
    <div>
        <button onclick="answer.value+='4'">4</button>
        <button onclick="answer.value+='5'">5</button>
        <button onclick="answer.value+='6'">6</button>
        <button onclick="answer.value+='-'">-</button>
    </div>
    <div>
        <button onclick="answer.value+='1'">1</button>
        <button onclick="answer.value+='2'">2</button>
        <button onclick="answer.value+='3'">3</button>
        <button onclick="answer.value+='+'">+</button>
    </div>
    <div>
        <button onclick="answer.value+=''">+/-</button>
        <button onclick="answer.value+='0'">0</button>
        <button onclick="answer.value+='.'">.</button>
        <button onclick="calc()">=</button>
    </div>

    <script>
        function calc() {
            temp = document.getElementById("answer");
            temp1 = answer.value;
            //console.log(temp1);

            // s1 = [answer.value];

           // a = ['9','x','9','+','(','10','-','5',')','/','2'];

            let a = []; 
            let k = 0;
            a[0] = temp1.charAt(0);
            for (let i = 1; i < temp1.length; i++) {
                if (temp1.charAt(i) == '+' || temp1.charAt(i) == '-' || temp1.charAt(i) == 'x' || temp1.charAt(i) == '/' || temp1.charAt(i) == '%' || temp1.charAt(i) == '(' || temp1.charAt(i) == ')' || temp1.charAt(i) == '!') {
                    k = k + 1
                    a[k] = temp1.charAt(i) + "";
                    
                    
                    k = k + 1;
                    a[k] = temp1.charAt(i + 1);
                    i++;
                    
                }
                else {
                    a[k] = a[k] + temp1.charAt(i);
                }
            }

            console.log(a);
            let ganatri;

            let opretors = {
                "!": function (a) {
                    for (let i = 1; i < a; i++) {
                        a = a * i;
                    }
                    return a;
                },
                "/": function (a, b) {
                    return a / b;
                },
                x: function (a, b) {
                    return a * b;
                },
                "+": function (a, b) {
                    return a + b;
                },
                "-": function (a, b) {
                    return a - b;
                },
            };

            let operator = ["/", "x", "+", "-"];
            let i = 0;


            while (a.includes("(")) {
                let b = [];
                let m = 0;
                for (j = a.indexOf("(") + 1; j < a.indexOf(")"); j++) {
                    b[m] = a[j];
                    m++;
                }
                console.log(b);
                console.log(b.length);
                while (b.length > 1) {
                    while (b.includes(operator[i])) {
                        let index = b.indexOf(operator[i]);

                        let first = Number(b[index - 1]);
                        let second = Number(b[index + 1]);

                        ganatri = opretors[operator[i]](first, second);

                        b[index - 1] = ganatri;
                        b.splice(index, 2);
                    }
                    i++;
                }
                let idx = a.indexOf("(");
                a[idx] = b[0];
                console.log(a[idx]);
                let idx2 = a.indexOf(")") - idx;
                a.splice(idx + 1, idx2);
                console.log(a);
            }

            i = 0;
            while (a.length > 1) {
                while (a.includes(operator[i])) {
                    let index = a.indexOf(operator[i]);

                    let first = Number(a[index - 1]);
                    let second = Number(a[index + 1]);

                    ganatri = opretors[operator[i]](first, second);

                    a[index - 1] = ganatri;
                    a.splice(index, 2);
                }
                i++;
            }

            console.log(ganatri);

            answer.value = ganatri;
            //document.write(2/2/4);
        }

        function cut() {
            answer.value = answer.value.slice(0, answer.value.length - 1);
            // slice() METHOD 1ST ARGU MA START INDEX LE ANE 2ND ARGU MA KETEL CHARCTER PRINT KARAVVA CHE TE MAGE;
        }
    </script>
</body>

</html>